<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Requesting a Did Power Up | Commercio.network Documentation</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/icon.png">
    <meta name="description" content="Documentation for the Commercio.network blockchain.">
    <link rel="preload" href="/assets/css/0.styles.443957a4.css" as="style"><link rel="preload" href="/assets/js/app.fc01e7b7.js" as="script"><link rel="preload" href="/assets/js/2.c02e0d5c.js" as="script"><link rel="preload" href="/assets/js/47.7f9d3842.js" as="script"><link rel="prefetch" href="/assets/js/10.31f4acaf.js"><link rel="prefetch" href="/assets/js/11.2199ab5f.js"><link rel="prefetch" href="/assets/js/12.7f6684d2.js"><link rel="prefetch" href="/assets/js/13.425c1d39.js"><link rel="prefetch" href="/assets/js/14.c1f91370.js"><link rel="prefetch" href="/assets/js/15.0771140f.js"><link rel="prefetch" href="/assets/js/16.538d4223.js"><link rel="prefetch" href="/assets/js/17.17994e77.js"><link rel="prefetch" href="/assets/js/18.9fef359e.js"><link rel="prefetch" href="/assets/js/19.fc3116e1.js"><link rel="prefetch" href="/assets/js/20.0c637c87.js"><link rel="prefetch" href="/assets/js/21.43db1350.js"><link rel="prefetch" href="/assets/js/22.4a4053a0.js"><link rel="prefetch" href="/assets/js/23.905974fc.js"><link rel="prefetch" href="/assets/js/24.fdb4e29f.js"><link rel="prefetch" href="/assets/js/25.8abf97fa.js"><link rel="prefetch" href="/assets/js/26.a6d7075b.js"><link rel="prefetch" href="/assets/js/27.0518e80c.js"><link rel="prefetch" href="/assets/js/28.093ef943.js"><link rel="prefetch" href="/assets/js/29.c07321d5.js"><link rel="prefetch" href="/assets/js/3.1a4e9b5f.js"><link rel="prefetch" href="/assets/js/30.88a999ba.js"><link rel="prefetch" href="/assets/js/31.bf5324f9.js"><link rel="prefetch" href="/assets/js/32.915d1a26.js"><link rel="prefetch" href="/assets/js/33.9e0d5422.js"><link rel="prefetch" href="/assets/js/34.2a03f619.js"><link rel="prefetch" href="/assets/js/35.59888ff9.js"><link rel="prefetch" href="/assets/js/36.d3329149.js"><link rel="prefetch" href="/assets/js/37.608eacea.js"><link rel="prefetch" href="/assets/js/38.08586596.js"><link rel="prefetch" href="/assets/js/39.e66de283.js"><link rel="prefetch" href="/assets/js/4.06f9b088.js"><link rel="prefetch" href="/assets/js/40.8f2f94c8.js"><link rel="prefetch" href="/assets/js/41.09ff4458.js"><link rel="prefetch" href="/assets/js/42.bfe11e8b.js"><link rel="prefetch" href="/assets/js/43.04273773.js"><link rel="prefetch" href="/assets/js/44.74c621f0.js"><link rel="prefetch" href="/assets/js/45.b78d82b8.js"><link rel="prefetch" href="/assets/js/46.4e531cad.js"><link rel="prefetch" href="/assets/js/48.d5e5ea10.js"><link rel="prefetch" href="/assets/js/49.25f58f52.js"><link rel="prefetch" href="/assets/js/5.05cd9398.js"><link rel="prefetch" href="/assets/js/50.deab75d8.js"><link rel="prefetch" href="/assets/js/51.c8f16cff.js"><link rel="prefetch" href="/assets/js/6.747ff8de.js"><link rel="prefetch" href="/assets/js/7.c582f4da.js"><link rel="prefetch" href="/assets/js/8.f6be4cca.js"><link rel="prefetch" href="/assets/js/9.e425be54.js">
    <link rel="stylesheet" href="/assets/css/0.styles.443957a4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Commercio.network Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://commercio.network" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Commercio.network
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/commercionetwork/commercionetwork" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://commercio.network" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Commercio.network
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/commercionetwork/commercionetwork" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Nodes</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nodes/" class="sidebar-link">Introduction</a></li><li><a href="/nodes/hardware-requirements.html" class="sidebar-link">Hardware requirements</a></li><li><a href="/nodes/full-node-installation.html" class="sidebar-link">Installing a full node</a></li><li><a href="/nodes/validator-node-installation.html" class="sidebar-link">Becoming a validator</a></li><li><a href="/nodes/validator-node-update.html" class="sidebar-link">Updating a validator</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>App Developers</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/app_developers/" class="sidebar-link">Introduction</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>SDK Developers</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/developers/" class="sidebar-link">Introduction</a></li><li><a href="/developers/create-sign-broadcast-tx.html" class="sidebar-link">Create, sign and send a transaction</a></li><li><a href="/developers/message-types.html" class="sidebar-link">Supported messages types</a></li><li><a href="/developers/listing-transactions.html" class="sidebar-link">Listing past transactions</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Modules</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/x/bank/" class="sidebar-link">Bank</a></li><li><a href="/x/government/" class="sidebar-link">Government</a></li><li><a href="/x/id/" class="sidebar-link">Id</a></li><li><a href="/x/docs/" class="sidebar-link">Docs</a></li><li><a href="/x/pricefeed/" class="sidebar-link">Pricefeed</a></li><li><a href="/x/commerciomint/" class="sidebar-link">CommercioMint</a></li><li><a href="/x/memberships/" class="sidebar-link">Memberships</a></li><li><a href="/x/vbr/" class="sidebar-link">VBR</a></li><li><a href="/x/creditrisk/" class="sidebar-link">Creditrisk</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="requesting-a-did-power-up"><a href="#requesting-a-did-power-up" class="header-anchor">#</a> Requesting a Did Power Up</h1> <p>A <em>Did Power Up</em> is the expression we use when referring to the willingness of a user to move a specified amount of tokens
from external centralized entity to one of his
private pairwise Did, making them able to send documents (which indeed require the user to spend some tokens as fees).</p> <p>A user who wants to execute a Did Power Up must have previously sent tokens to the public address of the centralized entity.</p> <p>This action is the second and final step that must be done when <a href="/x/id/creating-pairwise-did.html">creating a pairwise Did</a>.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>If you wish to know more about the overall pairwise Did creation sequence, please refer to the
<a href="/x/id/creating-pairwise-did.html">pairwise Did creation specification</a> page</p></div> <h2 id="transaction-message"><a href="#transaction-message" class="header-anchor">#</a> Transaction message</h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commercio/MsgRequestDidPowerUp&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;value&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;claimant&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address that sent funds to the centralized entity before&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">&quot;denom&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ucommercio&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amount to transfer to the pairwise did, integer&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;proof&quot;</span><span class="token operator">:</span> <span class="token string">&quot;proof string&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;randomly-generated UUID v4&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;proof_key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;proof encryption key&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="value-fields-requirements"><a href="#value-fields-requirements" class="header-anchor">#</a> <code>value</code> fields requirements</h3> <table><thead><tr><th style="text-align:center;">Field</th> <th style="text-align:center;">Required</th></tr></thead> <tbody><tr><td style="text-align:center;"><code>claimant</code></td> <td style="text-align:center;">Yes</td></tr> <tr><td style="text-align:center;"><code>amount</code></td> <td style="text-align:center;">Yes</td></tr> <tr><td style="text-align:center;"><code>proof</code></td> <td style="text-align:center;">Yes</td></tr> <tr><td style="text-align:center;"><code>id</code></td> <td style="text-align:center;">Yes</td></tr> <tr><td style="text-align:center;"><code>proof_key</code></td> <td style="text-align:center;">Yes</td></tr></tbody></table> <h3 id="creating-the-proof-value"><a href="#creating-the-proof-value" class="header-anchor">#</a> Creating the <code>proof</code> value</h3> <p>To create the <code>proof</code> field value, the following steps must be followed:</p> <ol><li><p>create the <code>signature_json</code> formed as follow.</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
 <span class="token string">&quot;sender_did&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user who sends the power-up request&quot;</span><span class="token punctuation">,</span>
 <span class="token string">&quot;pairwise_did&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pairwise address to power-up&quot;</span><span class="token punctuation">,</span>
 <span class="token string">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;UNIX-formatted timestamp&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>retrive the public key of external centralized entity <strong>Tk</strong>, by querying the <code>cncli</code> REST API</p></li> <li><p>calculate SHA-256 <code>HASH</code> of the concatenation of <code>sender_did</code>, <code>pairwise_did</code> and <code>timestamp</code> fields, taken from <code>signature_json</code></p></li> <li><p>do a PKCS1v15 signature of <code>HASH</code> with the RSA private key associated to RSA public key inserted in the <code>sender_did</code> DDO - this process yields the <code>SIGN(HASH)</code> value</p></li> <li><p>convert <code>SIGN(HASH)</code> in <strong>base64</strong> <code>BASE64(SIGN(HASH))</code>, this is the value to be placed in the <code>signature</code> field</p></li> <li><p>add the <code>signature</code> field to the <code>signature_json</code> JSON:</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
 <span class="token string">&quot;sender_did&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user who sends the power-up request&quot;</span><span class="token punctuation">,</span>
 <span class="token string">&quot;pairwise_did&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pairwise address to power-up&quot;</span><span class="token punctuation">,</span>
 <span class="token string">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;UNIX-formatted timestamp&quot;</span><span class="token punctuation">,</span>
 <span class="token string">&quot;signature&quot;</span><span class="token operator">:</span> <span class="token string">&quot;the value BASE64(SIGN(HASH))&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>create a random 256-bit <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard" target="_blank" rel="noopener noreferrer">AES-256<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> key <code>F</code></p></li> <li><p>generate a random 96-bit nonce <code>N</code></p></li> <li><p>using the AES-256 key generated at point (6), encrypt the <code>payload</code>:</p> <ol><li>remove all the white spaces and line ending characters</li> <li>encrypt the resulting string bytes using the <code>AES-GCM</code> mode, <code>F</code> as key, obtaining <code>CIPHERTEXT</code></li> <li>concatenate bytes of <code>CIPHERTEXT</code> and <code>N</code> and encode the resulting bytes in <strong>base64</strong>, obtaining the <code>value</code> <code>proof</code> content</li></ol></li> <li><p>encrypt the AES-256 key:</p> <ol><li>encrypt the <code>F</code> key bytes using the centralized entity's RSA public key found in its Did Document, in PKCS1v15 mode.</li> <li>encode the resulting bytes in <strong>base64</strong>, obtaining the <code>value</code> <code>proof_key</code> content</li></ol></li></ol> <h2 id="action-type"><a href="#action-type" class="header-anchor">#</a> Action type</h2> <p>If you want to <a href="/developers/listing-transactions.html">list past transactions</a> including this kind of message,
you need to use the following <code>message.action</code> value:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>requestDidPowerUp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/commercionetwork/commercionetwork/edit/master/docs/x/id/tx/request-did-power-up.md" target="_blank" rel="noopener noreferrer">Edit this page on Github</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/17/2020, 2:06:01 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.fc01e7b7.js" defer></script><script src="/assets/js/2.c02e0d5c.js" defer></script><script src="/assets/js/47.7f9d3842.js" defer></script>
  </body>
</html>
